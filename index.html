<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cyberpunk Card Validator</title>
    <script src="https://js.stripe.com/v3/"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap');
        
        body {
            font-family: 'Orbitron', sans-serif;
            color: #00ff9d;
            min-height: 100vh;
            overflow: hidden;
            position: relative;
            background-color: #0a0a0a; /* Fondo oscuro */
        }

        /* Contenedor principal con transparencia */
        .main-container {
            background-color: rgba(10, 10, 10, 0.8);
            backdrop-filter: blur(10px);
        }

        .cyberpunk-border {
            border: 2px solid #00ff9d;
            box-shadow: 
                0 0 10px #00ff9d,
                inset 0 0 10px #00ff9d;
            position: relative;
        }

        .cyberpunk-border::before {
            content: '';
            position: absolute;
            top: -5px;
            left: -5px;
            right: -5px;
            bottom: -5px;
            border: 1px solid #ff00a0;
            z-index: -1;
            animation: borderFlicker 3s infinite alternate;
        }

        @keyframes borderFlicker {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        .glow-text {
            text-shadow: 0 0 5px #00ff9d, 0 0 10px #00ff9d;
        }

        .neon-button {
            background: linear-gradient(135deg, #00ff9d, #00b879);
            box-shadow: 0 0 15px #00ff9d;
            transition: all 0.3s;
        }

        .neon-button:hover {
            box-shadow: 0 0 25px #00ff9d;
            transform: translateY(-2px);
        }

        .clear-button {
            background: linear-gradient(135deg, #ff6b6b, #ff0000);
            box-shadow: 0 0 15px #ff0000;
            transition: all 0.3s;
        }

        .clear-button:hover {
            box-shadow: 0 0 25px #ff0000;
        }

        .input-field {
            background: rgba(10, 10, 10, 0.5);
            border: 1px solid #333;
            transition: all 0.3s;
            color: white;
        }

        .input-field:focus {
            border-color: #00ff9d;
            box-shadow: 0 0 10px #00ff9d;
        }

        #api-status {
            transition: all 0.5s;
        }

        .status-online {
            background-color: rgba(0, 255, 0, 0.1);
            border-left: 4px solid #00ff00;
        }

        .status-offline {
            background-color: rgba(255, 0, 0, 0.1);
            border-left: 4px solid #ff0000;
        }

        .status-checking {
            background-color: rgba(255, 255, 0, 0.1);
            border-left: 4px solid #ffff00;
        }

        #loading-bar {
            box-shadow: 0 0 5px #00ff9d;
        }
        
        #loading-progress {
            box-shadow: 0 0 10px #00ff9d;
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
    </style>
</head>
<body class="flex items-center justify-center p-4">
    <div class="main-container cyberpunk-border w-full max-w-3xl p-8 rounded-lg">
        <!-- API Status Indicator -->
        <div id="api-status" class="status-checking mb-4 p-3 rounded flex items-center">
            <div class="w-3 h-3 rounded-full mr-2 bg-yellow-500 animate-pulse"></div>
            <span class="text-sm">Checking Stripe API status...</span>
        </div>

        <div class="text-center mb-8">
            <h1 class="glow-text text-3xl font-bold mb-2">CARD VALIDATOR v3.1.4</h1>
            <p class="text-sm text-gray-400">SECURE PAYMENT GATEWAY</p>
        </div>

        <div class="mb-4">
            <label class="block text-sm mb-2">PASTE CARDS (format: number|mm|yyyy|cvv)</label>
            <textarea id="bulk-card-input" class="input-field p-3 rounded-lg w-full h-40 text-white"></textarea>
        </div>

        <div class="flex space-x-4 mb-4">
            <button id="submit-button" class="neon-button flex-1 py-3 rounded-lg text-black font-bold uppercase tracking-wider">
                VERIFY CARDS
            </button>
            <button id="clear-button" class="clear-button flex-1 py-3 rounded-lg text-white font-bold uppercase tracking-wider">
                CLEAR ALL
            </button>
        </div>

        <div id="stats-container" class="cyberpunk-border p-4 rounded-lg mt-4">
            <div class="grid grid-cols-3 gap-4">
                <div class="col-span-1">
                    <h4 class="font-bold text-green-400 mb-2">Valid: <span id="valid-count">0</span></h4>
                    <div id="valid-cards-list" class="text-xs overflow-y-auto max-h-40"></div>
                </div>
                
                <div class="col-span-1">
                    <h4 class="font-bold text-red-400 mb-2">Declined: <span id="denied-count">0</span></h4>
                    <div id="denied-cards-list" class="text-xs overflow-y-auto max-h-40"></div>
                </div>
                
                <div class="col-span-1">
                    <h4 class="font-bold text-yellow-400 mb-2">Errors: <span id="error-count">0</span></h4>
                    <div id="error-cards-list" class="text-xs overflow-y-auto max-h-40"></div>
                </div>
            </div>
        </div>

        <div id="loading-bar" class="hidden h-2 mb-4 bg-gray-800 rounded-full overflow-hidden">
            <div id="loading-progress" class="h-full bg-green-500 transition-all duration-300" style="width: 0%"></div>
        </div>
    </div>

    <script>
        const stripe = Stripe('pk_test_51RqVXnFlohupnYdqp7N4QpXCCe8BDCHPdjCbxV6XeU28hgmGNCRk3QS8prKrPaVIo3ko65JrH1CXsyPTag2IvZ8m00jBEIO9rI');
        const submitButton = document.getElementById('submit-button');
        const clearButton = document.getElementById('clear-button');
        const bulkInput = document.getElementById('bulk-card-input');
        const loadingBar = document.getElementById('loading-bar');
        const loadingProgress = document.getElementById('loading-progress');
        const apiStatus = document.getElementById('api-status');

        // Función para verificar el estado de la API
        async function checkAPIStatus() {
            try {
                apiStatus.className = 'status-checking mb-4 p-3 rounded flex items-center';
                apiStatus.innerHTML = '<div class="w-3 h-3 rounded-full mr-2 bg-yellow-500 animate-pulse"></div><span class="text-sm">Checking Stripe API status...</span>';
                
                const response = await fetch('https://api.stripe.com/v1/', {
                    method: 'HEAD',
                    headers: {
                        'Authorization': `Bearer ${stripe._apiKey}`
                    }
                });
                
                if (response.ok) {
                    apiStatus.className = 'status-online mb-4 p-3 rounded flex items-center';
                    apiStatus.innerHTML = '<div class="w-3 h-3 rounded-full mr-2 bg-green-500"></div><span class="text-sm">Stripe API: ONLINE (Test Mode)</span>';
                } else {
                    apiStatus.className = 'status-offline mb-4 p-3 rounded flex items-center';
                    apiStatus.innerHTML = '<div class="w-3 h-3 rounded-full mr-2 bg-red-500"></div><span class="text-sm">Stripe API: OFFLINE</span>';
                }
            } catch (error) {
                apiStatus.className = 'status-offline mb-4 p-3 rounded flex items-center';
                apiStatus.innerHTML = '<div class="w-3 h-3 rounded-full mr-2 bg-red-500"></div><span class="text-sm">Stripe API: CONNECTION ERROR</span>';
            }
        }

        // Función para limpiar resultados
        function clearResults() {
            document.getElementById('valid-count').textContent = '0';
            document.getElementById('denied-count').textContent = '0';
            document.getElementById('error-count').textContent = '0';
            document.getElementById('valid-cards-list').innerHTML = '';
            document.getElementById('denied-cards-list').innerHTML = '';
            document.getElementById('error-cards-list').innerHTML = '';
            loadingProgress.style.width = '0%';
            loadingBar.classList.add('hidden');
        }

        // Evento para el botón CLEAR ALL
        clearButton.addEventListener('click', clearResults);

        // Evento para el botón VERIFY CARDS
        submitButton.addEventListener('click', async () => {
            // Reset UI
            clearResults();
            
            // Show loading
            submitButton.disabled = true;
            submitButton.textContent = "PROCESSING...";
            loadingBar.classList.remove('hidden');

            const cardLines = bulkInput.value.trim().split('\n').filter(line => line.trim());
            const totalCards = cardLines.length;
            let processedCards = 0;
            let validCards = 0;
            let declinedCards = 0;
            let errorCards = 0;

            for (const line of cardLines) {
                try {
                    const parts = line.split('|').map(p => p.trim());
                    if (parts.length !== 4) {
                        throw new Error('Invalid format');
                    }

                    const [number, expMonth, expYear, cvc] = parts;
                    const last4 = number.slice(-4);

                    const { error } = await stripe.createPaymentMethod({
                        type: 'card',
                        card: {
                            number,
                            exp_month: expMonth,
                            exp_year: expYear,
                            cvc
                        }
                    });

                    processedCards++;
                    const progress = Math.floor((processedCards / totalCards) * 100);
                    loadingProgress.style.width = `${progress}%`;

                    if (error) {
                        declinedCards++;
                        document.getElementById('denied-count').textContent = declinedCards;
                        document.getElementById('denied-cards-list').innerHTML += 
                            `<div class="mb-1">••••${last4} - ${error.message}</div>`;
                    } else {
                        validCards++;
                        document.getElementById('valid-count').textContent = validCards;
                        document.getElementById('valid-cards-list').innerHTML += 
                            `<div class="mb-1">••••${last4} - Valid</div>`;
                    }
                } catch (error) {
                    errorCards++;
                    document.getElementById('error-count').textContent = errorCards;
                    document.getElementById('error-cards-list').innerHTML += 
                        `<div class="mb-1 text-red-400">${line} - ${error.message}</div>`;
                    processedCards++;
                }
            }

            // Complete processing
            submitButton.disabled = false;
            submitButton.textContent = "VERIFY CARDS";
            setTimeout(() => loadingBar.classList.add('hidden'), 1000);
        });

        // Verificar estado de la API al cargar la página
        checkAPIStatus();
        
        // Verificar periódicamente el estado de la API (cada 5 minutos)
        setInterval(checkAPIStatus, 300000);
    </script>
</body>
</html>
